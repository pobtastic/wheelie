<!DOCTYPE html>
<html>
<head>
<title>Wheelie: Routine at ED52</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../wheelie.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-75RERFCHBG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-75RERFCHBG');
</script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="ECAB.html">ECAB</a>
</td>
<td class="up">Up: <a href="../maps/all.html#ed52">Map</a></td>
<td class="next">
Next: <a href="EE09.html">EE09</a>
</td>
</tr>
</table>
<div class="description">ED52: Playing Instruction display routine</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="ed52"></span>ED52</td>
<td class="instruction">EXX</td>
<td class="comment-1" rowspan="1">Exchange <span class="register">BC</span>, <span class="register">DE</span>, and <span class="register">HL</span> with shadow registers with <span class="register">BC'</span>, <span class="register">DE'</span>, and <span class="register">HL'</span></td>
</tr>
<tr>
<td class="address-1"><span id="ed53"></span>ED53</td>
<td class="instruction">LD DE,$4000</td>
<td class="comment-1" rowspan="1"><span class="register">DE</span>=$4000 (top of the screen buffer)</td>
</tr>
<tr>
<td class="address-1"><span id="ed56"></span>ED56</td>
<td class="instruction">EXX</td>
<td class="comment-1" rowspan="1">Exchange <span class="register">BC</span>, <span class="register">DE</span>, and <span class="register">HL</span> with shadow registers with <span class="register">BC'</span>, <span class="register">DE'</span>, and <span class="register">HL'</span></td>
</tr>
<tr>
<td class="address-1"><span id="ed57"></span>ED57</td>
<td class="instruction">LD HL,$EE74</td>
<td class="comment-1" rowspan="3">Point <span class="register">HL</span> to <a href="EE74.html">EE74</a> ($20 characters in length) and call <a href="74AA.html#74d3">74D3</a></td>
</tr>
<tr>
<td class="address-1"><span id="ed5a"></span>ED5A</td>
<td class="instruction">LD B,$20</td>
</tr>
<tr>
<td class="address-1"><span id="ed5c"></span>ED5C</td>
<td class="instruction">CALL <a href="74AA.html#74d3">$74D3</a></td>
</tr>
<tr>
<td class="address-1"><span id="ed5f"></span>ED5F</td>
<td class="instruction">LD A,$9F</td>
<td class="comment-1" rowspan="3">Point <span class="register">HL</span> to <a href="EE94.html">EE94</a> and call the subroutine at <a href="74AA.html#74c3">74C3</a> with $9F (magenta/ white with flash toggled)</td>
</tr>
<tr>
<td class="address-1"><span id="ed61"></span>ED61</td>
<td class="instruction">LD HL,$EE94</td>
</tr>
<tr>
<td class="address-1"><span id="ed64"></span>ED64</td>
<td class="instruction">CALL <a href="74AA.html#74c3">$74C3</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="ed67"></span>
<div class="comments">
<div class="paragraph">
Colours the screen for page one.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="ed67"></span>ED67</td>
<td class="instruction">LD HL,$5840</td>
<td class="comment-1" rowspan="5">Write $28 (cyan/ black) to the attribute buffer $A0 times, starting from $5840</td>
</tr>
<tr>
<td class="address-1"><span id="ed6a"></span>ED6A</td>
<td class="instruction">LD B,$A0</td>
</tr>
<tr>
<td class="address-2"><span id="ed6c"></span>ED6C</td>
<td class="instruction">LD (HL),$28</td>
</tr>
<tr>
<td class="address-1"><span id="ed6e"></span>ED6E</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="address-1"><span id="ed6f"></span>ED6F</td>
<td class="instruction">DJNZ <a href="ED52.html#ed6c">$ED6C</a></td>
</tr>
<tr>
<td class="address-1"><span id="ed71"></span>ED71</td>
<td class="instruction">LD B,$C0</td>
<td class="comment-1" rowspan="4">Write $30 (yellow/ black) to the attribute buffer $C0 times</td>
</tr>
<tr>
<td class="address-2"><span id="ed73"></span>ED73</td>
<td class="instruction">LD (HL),$30</td>
</tr>
<tr>
<td class="address-1"><span id="ed75"></span>ED75</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="address-1"><span id="ed76"></span>ED76</td>
<td class="instruction">DJNZ <a href="ED52.html#ed73">$ED73</a></td>
</tr>
<tr>
<td class="address-1"><span id="ed78"></span>ED78</td>
<td class="instruction">LD B,$E0</td>
<td class="comment-1" rowspan="4">Write $20 (green/ black) to the attribute buffer $E0 times</td>
</tr>
<tr>
<td class="address-2"><span id="ed7a"></span>ED7A</td>
<td class="instruction">LD (HL),$20</td>
</tr>
<tr>
<td class="address-1"><span id="ed7c"></span>ED7C</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="address-1"><span id="ed7d"></span>ED7D</td>
<td class="instruction">DJNZ <a href="ED52.html#ed7a">$ED7A</a></td>
</tr>
<tr>
<td class="address-1"><span id="ed7f"></span>ED7F</td>
<td class="instruction">LD B,$60</td>
<td class="comment-1" rowspan="4">Write $28 (cyan/ black) to the attribute buffer $60 times</td>
</tr>
<tr>
<td class="address-2"><span id="ed81"></span>ED81</td>
<td class="instruction">LD (HL),$28</td>
</tr>
<tr>
<td class="address-1"><span id="ed83"></span>ED83</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="address-1"><span id="ed84"></span>ED84</td>
<td class="instruction">DJNZ <a href="ED52.html#ed81">$ED81</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="ed86"></span>
<div class="comments">
<div class="paragraph">
Displays the instructions for page one.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="ed86"></span>ED86</td>
<td class="instruction">LD HL,$F000</td>
<td class="comment-1" rowspan="2">Point <span class="register">HL</span> to <a href="F000.html">F000</a> and call <a href="EC8E.html">EC8E</a></td>
</tr>
<tr>
<td class="address-1"><span id="ed89"></span>ED89</td>
<td class="instruction">CALL <a href="EC8E.html">$EC8E</a></td>
</tr>
<tr>
<td class="address-1"><span id="ed8c"></span>ED8C</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="1">Store our position in the instructions for later</td>
</tr>
<tr>
<td class="address-1"><span id="ed8d"></span>ED8D</td>
<td class="instruction">CALL <a href="EBE6.html">$EBE6</a></td>
<td class="comment-1" rowspan="1">Pause before allowing input (debounce)</td>
</tr>
<tr>
<td class="address-2"><span id="ed90"></span>ED90</td>
<td class="instruction">CALL <a href="6400.html#6828">$6828</a></td>
<td class="comment-1" rowspan="3">Loop until a key is pressed (using <a href="6400.html#6828">6828</a>)</td>
</tr>
<tr>
<td class="address-1"><span id="ed93"></span>ED93</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="address-1"><span id="ed94"></span>ED94</td>
<td class="instruction">JR Z,<a href="ED52.html#ed90">$ED90</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="ed96"></span>
<div class="comments">
<div class="paragraph">
Displays the instructions for page two.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="ed96"></span>ED96</td>
<td class="instruction">LD HL,$5840</td>
<td class="comment-1" rowspan="5">Writes $0F (blue/ white) to the attribute buffer $029F times starting at $5840</td>
</tr>
<tr>
<td class="address-1"><span id="ed99"></span>ED99</td>
<td class="instruction">LD (HL),$0F</td>
</tr>
<tr>
<td class="address-1"><span id="ed9b"></span>ED9B</td>
<td class="instruction">LD DE,$5841</td>
</tr>
<tr>
<td class="address-1"><span id="ed9e"></span>ED9E</td>
<td class="instruction">LD BC,$029F</td>
</tr>
<tr>
<td class="address-1"><span id="eda1"></span>EDA1</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="address-1"><span id="eda3"></span>EDA3</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="2">Restore our place in the instructions and call <a href="EC8E.html">EC8E</a></td>
</tr>
<tr>
<td class="address-1"><span id="eda4"></span>EDA4</td>
<td class="instruction">CALL <a href="EC8E.html">$EC8E</a></td>
</tr>
<tr>
<td class="address-1"><span id="eda7"></span>EDA7</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="1">Store our position in the instructions for later</td>
</tr>
<tr>
<td class="address-1"><span id="eda8"></span>EDA8</td>
<td class="instruction">CALL <a href="EBE6.html">$EBE6</a></td>
<td class="comment-1" rowspan="1">Pause before allowing input (debounce)</td>
</tr>
<tr>
<td class="address-2"><span id="edab"></span>EDAB</td>
<td class="instruction">CALL <a href="6400.html#6828">$6828</a></td>
<td class="comment-1" rowspan="3">Loop until a key is pressed (using <a href="6400.html#6828">6828</a>)</td>
</tr>
<tr>
<td class="address-1"><span id="edae"></span>EDAE</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="address-1"><span id="edaf"></span>EDAF</td>
<td class="instruction">JR Z,<a href="ED52.html#edab">$EDAB</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="edb1"></span>
<div class="comments">
<div class="paragraph">
Colours the screen for page three.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="edb1"></span>EDB1</td>
<td class="instruction">LD HL,$5960</td>
<td class="comment-1" rowspan="5">Write $28 (cyan/ black) to the attribute buffer $80 times, starting from $5960</td>
</tr>
<tr>
<td class="address-1"><span id="edb4"></span>EDB4</td>
<td class="instruction">LD B,$80</td>
</tr>
<tr>
<td class="address-2"><span id="edb6"></span>EDB6</td>
<td class="instruction">LD (HL),$28</td>
</tr>
<tr>
<td class="address-1"><span id="edb8"></span>EDB8</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="address-1"><span id="edb9"></span>EDB9</td>
<td class="instruction">DJNZ <a href="ED52.html#edb6">$EDB6</a></td>
</tr>
<tr>
<td class="address-1"><span id="edbb"></span>EDBB</td>
<td class="instruction">LD B,$A0</td>
<td class="comment-1" rowspan="4">Write $20 (green/ black) to the attribute buffer $A0 times</td>
</tr>
<tr>
<td class="address-2"><span id="edbd"></span>EDBD</td>
<td class="instruction">LD (HL),$20</td>
</tr>
<tr>
<td class="address-1"><span id="edbf"></span>EDBF</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="address-1"><span id="edc0"></span>EDC0</td>
<td class="instruction">DJNZ <a href="ED52.html#edbd">$EDBD</a></td>
</tr>
<tr>
<td class="address-1"><span id="edc2"></span>EDC2</td>
<td class="instruction">LD B,$60</td>
<td class="comment-1" rowspan="4">Write $30 (yellow/ black) to the attribute buffer $60 times</td>
</tr>
<tr>
<td class="address-2"><span id="edc4"></span>EDC4</td>
<td class="instruction">LD (HL),$30</td>
</tr>
<tr>
<td class="address-1"><span id="edc6"></span>EDC6</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="address-1"><span id="edc7"></span>EDC7</td>
<td class="instruction">DJNZ <a href="ED52.html#edc4">$EDC4</a></td>
</tr>
<tr>
<td class="address-1"><span id="edc9"></span>EDC9</td>
<td class="instruction">LD HL,$5860</td>
<td class="comment-1" rowspan="12">Cycles through the following $04 times (initially starting at $5860); <ul class="">
<li>Write $1B (magenta/ magenta) to the attribute buffer $09 times</li>
<li>Add $0037 to the position of the attribute buffer</li>
</ul> One this is finished, it "pokes a hole" at $5924 making it the same colour as the background $09 (blue/ blue) this gives a 4x4 magenta strip on the bottom row as the text refers to keys on the left and right.</td>
</tr>
<tr>
<td class="address-1"><span id="edcc"></span>EDCC</td>
<td class="instruction">LD DE,$0037</td>
</tr>
<tr>
<td class="address-1"><span id="edcf"></span>EDCF</td>
<td class="instruction">LD C,$04</td>
</tr>
<tr>
<td class="address-2"><span id="edd1"></span>EDD1</td>
<td class="instruction">LD B,$09</td>
</tr>
<tr>
<td class="address-2"><span id="edd3"></span>EDD3</td>
<td class="instruction">LD (HL),$1B</td>
</tr>
<tr>
<td class="address-1"><span id="edd5"></span>EDD5</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="address-1"><span id="edd6"></span>EDD6</td>
<td class="instruction">DJNZ <a href="ED52.html#edd3">$EDD3</a></td>
</tr>
<tr>
<td class="address-1"><span id="edd8"></span>EDD8</td>
<td class="instruction">ADD HL,DE</td>
</tr>
<tr>
<td class="address-1"><span id="edd9"></span>EDD9</td>
<td class="instruction">DEC C</td>
</tr>
<tr>
<td class="address-1"><span id="edda"></span>EDDA</td>
<td class="instruction">JR NZ,<a href="ED52.html#edd1">$EDD1</a></td>
</tr>
<tr>
<td class="address-1"><span id="eddc"></span>EDDC</td>
<td class="instruction">LD L,$24</td>
</tr>
<tr>
<td class="address-1"><span id="edde"></span>EDDE</td>
<td class="instruction">LD (HL),$09</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="ede0"></span>
<div class="comments">
<div class="paragraph">
Displays the instructions for page three.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="ede0"></span>EDE0</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="1">Restore our place in the instructions and call <a href="EC8E.html">EC8E</a></td>
</tr>
<tr>
<td class="address-1"><span id="ede1"></span>EDE1</td>
<td class="instruction">CALL <a href="EC8E.html">$EC8E</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="ede4"></span>EDE4</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="1">Store our position in the instructions for later</td>
</tr>
<tr>
<td class="address-1"><span id="ede5"></span>EDE5</td>
<td class="instruction">CALL <a href="EBE6.html">$EBE6</a></td>
<td class="comment-1" rowspan="1">Pause before allowing input (debounce)</td>
</tr>
<tr>
<td class="address-2"><span id="ede8"></span>EDE8</td>
<td class="instruction">CALL <a href="6400.html#6828">$6828</a></td>
<td class="comment-1" rowspan="3">Loop until a key is pressed (using <a href="6400.html#6828">6828</a>)</td>
</tr>
<tr>
<td class="address-1"><span id="edeb"></span>EDEB</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="address-1"><span id="edec"></span>EDEC</td>
<td class="instruction">JR Z,<a href="ED52.html#ede8">$EDE8</a></td>
</tr>
<tr>
<td class="address-1"><span id="edee"></span>EDEE</td>
<td class="instruction">LD HL,$5840</td>
<td class="comment-1" rowspan="5">Writes $30 (yellow/ black) to the attribute buffer $029F times starting at $5840</td>
</tr>
<tr>
<td class="address-1"><span id="edf1"></span>EDF1</td>
<td class="instruction">LD (HL),$30</td>
</tr>
<tr>
<td class="address-1"><span id="edf3"></span>EDF3</td>
<td class="instruction">LD DE,$5841</td>
</tr>
<tr>
<td class="address-1"><span id="edf6"></span>EDF6</td>
<td class="instruction">LD BC,$029F</td>
</tr>
<tr>
<td class="address-1"><span id="edf9"></span>EDF9</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="address-1"><span id="edfb"></span>EDFB</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="2">Restore our place in the instructions and call <a href="EC8E.html">EC8E</a></td>
</tr>
<tr>
<td class="address-1"><span id="edfc"></span>EDFC</td>
<td class="instruction">CALL <a href="EC8E.html">$EC8E</a></td>
</tr>
<tr>
<td class="address-1"><span id="edff"></span>EDFF</td>
<td class="instruction">CALL <a href="EBE6.html">$EBE6</a></td>
<td class="comment-1" rowspan="1">Pause before allowing input (debounce)</td>
</tr>
<tr>
<td class="address-2"><span id="ee02"></span>EE02</td>
<td class="instruction">CALL <a href="6400.html#6828">$6828</a></td>
<td class="comment-1" rowspan="3">Loop until a key is pressed (using <a href="6400.html#6828">6828</a>)</td>
</tr>
<tr>
<td class="address-1"><span id="ee05"></span>EE05</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="address-1"><span id="ee06"></span>EE06</td>
<td class="instruction">JR Z,<a href="ED52.html#ee02">$EE02</a></td>
</tr>
<tr>
<td class="address-1"><span id="ee08"></span>EE08</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="ECAB.html">ECAB</a>
</td>
<td class="up">Up: <a href="../maps/all.html#ed52">Map</a></td>
<td class="next">
Next: <a href="EE09.html">EE09</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; 1983 Microsphere &copy; 2021 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.6.</div>
<div><a href="../dec/asm/60754.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>