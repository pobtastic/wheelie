<!DOCTYPE html>
<html>
<head>
<title>Wheelie: Routine at ED52</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../wheelie.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="60587.html">ECAB</a>
</td>
<td class="up">Up: <a href="../maps/all.html#60754">Map</a></td>
<td class="next">
Next: <a href="60937.html">EE09</a>
</td>
</tr>
</table>
<div class="description">ED52: Playing Instruction display routine</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="60754"></span>ED52</td>
<td class="instruction">EXX</td>
<td class="comment-1" rowspan="1">Exchange <span class="register">BC</span>, <span class="register">DE</span>, and <span class="register">HL</span> with shadow registers with <span class="register">BC'</span>, <span class="register">DE'</span>, and <span class="register">HL'</span></td>
</tr>
<tr>
<td class="address-1"><span id="60755"></span>ED53</td>
<td class="instruction">LD DE,$4000</td>
<td class="comment-1" rowspan="1"><span class="register">DE</span>=$4000 (top of the screen buffer)</td>
</tr>
<tr>
<td class="address-1"><span id="60758"></span>ED56</td>
<td class="instruction">EXX</td>
<td class="comment-1" rowspan="1">Exchange <span class="register">BC</span>, <span class="register">DE</span>, and <span class="register">HL</span> with shadow registers with <span class="register">BC'</span>, <span class="register">DE'</span>, and <span class="register">HL'</span></td>
</tr>
<tr>
<td class="address-1"><span id="60759"></span>ED57</td>
<td class="instruction">LD HL,$EE74</td>
<td class="comment-1" rowspan="3">Point <span class="register">HL</span> to <a href="61044.html">INSTRUCTIONS_HEADER</a> ($20 characters in length) and call <a href="29866.html#29907">PRINT_STRING</a></td>
</tr>
<tr>
<td class="address-1"><span id="60762"></span>ED5A</td>
<td class="instruction">LD B,$20</td>
</tr>
<tr>
<td class="address-1"><span id="60764"></span>ED5C</td>
<td class="instruction">CALL <a href="29866.html#29907">PRINT_STRING</a></td>
</tr>
<tr>
<td class="address-1"><span id="60767"></span>ED5F</td>
<td class="instruction">LD A,$9F</td>
<td class="comment-1" rowspan="3">Point <span class="register">HL</span> to <a href="61076.html">PRESSANYKEY_TEXT</a> and call the subroutine at <a href="29866.html#29891">PRINT_BIKE_GRAPHIC_1</a> with $9F (magenta/ white with flash toggled)</td>
</tr>
<tr>
<td class="address-1"><span id="60769"></span>ED61</td>
<td class="instruction">LD HL,$EE94</td>
</tr>
<tr>
<td class="address-1"><span id="60772"></span>ED64</td>
<td class="instruction">CALL <a href="29866.html#29891">PRINT_BIKE_GRAPHIC_1</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="60775"></span>
<div class="comments">
<div class="paragraph">
Colours the screen for page one.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="60775"></span>ED67</td>
<td class="instruction">LD HL,$5840</td>
<td class="comment-1" rowspan="5">Write $28 (cyan/ black) to the attribute buffer $A0 times, starting from $5840</td>
</tr>
<tr>
<td class="address-1"><span id="60778"></span>ED6A</td>
<td class="instruction">LD B,$A0</td>
</tr>
<tr>
<td class="address-2"><span id="60780"></span>ED6C</td>
<td class="instruction">LD (HL),$28</td>
</tr>
<tr>
<td class="address-1"><span id="60782"></span>ED6E</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="address-1"><span id="60783"></span>ED6F</td>
<td class="instruction">DJNZ $ED6C</td>
</tr>
<tr>
<td class="address-1"><span id="60785"></span>ED71</td>
<td class="instruction">LD B,$C0</td>
<td class="comment-1" rowspan="4">Write $30 (yellow/ black) to the attribute buffer $C0 times</td>
</tr>
<tr>
<td class="address-2"><span id="60787"></span>ED73</td>
<td class="instruction">LD (HL),$30</td>
</tr>
<tr>
<td class="address-1"><span id="60789"></span>ED75</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="address-1"><span id="60790"></span>ED76</td>
<td class="instruction">DJNZ $ED73</td>
</tr>
<tr>
<td class="address-1"><span id="60792"></span>ED78</td>
<td class="instruction">LD B,$E0</td>
<td class="comment-1" rowspan="4">Write $20 (green/ black) to the attribute buffer $E0 times</td>
</tr>
<tr>
<td class="address-2"><span id="60794"></span>ED7A</td>
<td class="instruction">LD (HL),$20</td>
</tr>
<tr>
<td class="address-1"><span id="60796"></span>ED7C</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="address-1"><span id="60797"></span>ED7D</td>
<td class="instruction">DJNZ $ED7A</td>
</tr>
<tr>
<td class="address-1"><span id="60799"></span>ED7F</td>
<td class="instruction">LD B,$60</td>
<td class="comment-1" rowspan="4">Write $28 (cyan/ black) to the attribute buffer $60 times</td>
</tr>
<tr>
<td class="address-2"><span id="60801"></span>ED81</td>
<td class="instruction">LD (HL),$28</td>
</tr>
<tr>
<td class="address-1"><span id="60803"></span>ED83</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="address-1"><span id="60804"></span>ED84</td>
<td class="instruction">DJNZ $ED81</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="60806"></span>
<div class="comments">
<div class="paragraph">
Displays the instructions for page one.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="60806"></span>ED86</td>
<td class="instruction">LD HL,$F000</td>
<td class="comment-1" rowspan="2">Point <span class="register">HL</span> to <a href="61440.html">INSTRUCTIONS</a> and call <a href="60558.html">PRINT_INSTRUCTIONS</a></td>
</tr>
<tr>
<td class="address-1"><span id="60809"></span>ED89</td>
<td class="instruction">CALL <a href="60558.html">PRINT_INSTRUCTIONS</a></td>
</tr>
<tr>
<td class="address-1"><span id="60812"></span>ED8C</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="1">Store our position in the instructions for later</td>
</tr>
<tr>
<td class="address-1"><span id="60813"></span>ED8D</td>
<td class="instruction">CALL <a href="60390.html">PAUSE</a></td>
<td class="comment-1" rowspan="1">Pause before allowing input (debounce)</td>
</tr>
<tr>
<td class="address-2"><span id="60816"></span>ED90</td>
<td class="instruction">CALL <a href="25600.html#26664">$6828</a></td>
<td class="comment-1" rowspan="3">Loop until a key is pressed (using <a href="25600.html#26664">6828</a>)</td>
</tr>
<tr>
<td class="address-1"><span id="60819"></span>ED93</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="address-1"><span id="60820"></span>ED94</td>
<td class="instruction">JR Z,$ED90</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="60822"></span>
<div class="comments">
<div class="paragraph">
Displays the instructions for page two.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="60822"></span>ED96</td>
<td class="instruction">LD HL,$5840</td>
<td class="comment-1" rowspan="5">Writes $0F (blue/ white) to the attribute buffer $029F times starting at $5840</td>
</tr>
<tr>
<td class="address-1"><span id="60825"></span>ED99</td>
<td class="instruction">LD (HL),$0F</td>
</tr>
<tr>
<td class="address-1"><span id="60827"></span>ED9B</td>
<td class="instruction">LD DE,$5841</td>
</tr>
<tr>
<td class="address-1"><span id="60830"></span>ED9E</td>
<td class="instruction">LD BC,$029F</td>
</tr>
<tr>
<td class="address-1"><span id="60833"></span>EDA1</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="address-1"><span id="60835"></span>EDA3</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="2">Restore our place in the instructions and call <a href="60558.html">PRINT_INSTRUCTIONS</a></td>
</tr>
<tr>
<td class="address-1"><span id="60836"></span>EDA4</td>
<td class="instruction">CALL <a href="60558.html">PRINT_INSTRUCTIONS</a></td>
</tr>
<tr>
<td class="address-1"><span id="60839"></span>EDA7</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="1">Store our position in the instructions for later</td>
</tr>
<tr>
<td class="address-1"><span id="60840"></span>EDA8</td>
<td class="instruction">CALL <a href="60390.html">PAUSE</a></td>
<td class="comment-1" rowspan="1">Pause before allowing input (debounce)</td>
</tr>
<tr>
<td class="address-2"><span id="60843"></span>EDAB</td>
<td class="instruction">CALL <a href="25600.html#26664">$6828</a></td>
<td class="comment-1" rowspan="3">Loop until a key is pressed (using <a href="25600.html#26664">6828</a>)</td>
</tr>
<tr>
<td class="address-1"><span id="60846"></span>EDAE</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="address-1"><span id="60847"></span>EDAF</td>
<td class="instruction">JR Z,$EDAB</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="60849"></span>
<div class="comments">
<div class="paragraph">
Colours the screen for page three.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="60849"></span>EDB1</td>
<td class="instruction">LD HL,$5960</td>
<td class="comment-1" rowspan="5">Write $28 (cyan/ black) to the attribute buffer $80 times, starting from $5960</td>
</tr>
<tr>
<td class="address-1"><span id="60852"></span>EDB4</td>
<td class="instruction">LD B,$80</td>
</tr>
<tr>
<td class="address-2"><span id="60854"></span>EDB6</td>
<td class="instruction">LD (HL),$28</td>
</tr>
<tr>
<td class="address-1"><span id="60856"></span>EDB8</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="address-1"><span id="60857"></span>EDB9</td>
<td class="instruction">DJNZ $EDB6</td>
</tr>
<tr>
<td class="address-1"><span id="60859"></span>EDBB</td>
<td class="instruction">LD B,$A0</td>
<td class="comment-1" rowspan="4">Write $20 (green/ black) to the attribute buffer $A0 times</td>
</tr>
<tr>
<td class="address-2"><span id="60861"></span>EDBD</td>
<td class="instruction">LD (HL),$20</td>
</tr>
<tr>
<td class="address-1"><span id="60863"></span>EDBF</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="address-1"><span id="60864"></span>EDC0</td>
<td class="instruction">DJNZ $EDBD</td>
</tr>
<tr>
<td class="address-1"><span id="60866"></span>EDC2</td>
<td class="instruction">LD B,$60</td>
<td class="comment-1" rowspan="4">Write $30 (yellow/ black) to the attribute buffer $60 times</td>
</tr>
<tr>
<td class="address-2"><span id="60868"></span>EDC4</td>
<td class="instruction">LD (HL),$30</td>
</tr>
<tr>
<td class="address-1"><span id="60870"></span>EDC6</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="address-1"><span id="60871"></span>EDC7</td>
<td class="instruction">DJNZ $EDC4</td>
</tr>
<tr>
<td class="address-1"><span id="60873"></span>EDC9</td>
<td class="instruction">LD HL,$5860</td>
<td class="comment-1" rowspan="12">Cycles through the following $04 times (initially starting at $5860); <ul class="">
<li>Write $1B (magenta/ magenta) to the attribute buffer $09 times</li>
<li>Add $0037 to the position of the attribute buffer</li>
</ul> One this is finished, it "pokes a hole" at $5924 making it the same colour as the background $09 (blue/ blue) this gives a 4x4 magenta strip on the bottom row as the text refers to keys on the left and right.</td>
</tr>
<tr>
<td class="address-1"><span id="60876"></span>EDCC</td>
<td class="instruction">LD DE,$0037</td>
</tr>
<tr>
<td class="address-1"><span id="60879"></span>EDCF</td>
<td class="instruction">LD C,$04</td>
</tr>
<tr>
<td class="address-2"><span id="60881"></span>EDD1</td>
<td class="instruction">LD B,$09</td>
</tr>
<tr>
<td class="address-2"><span id="60883"></span>EDD3</td>
<td class="instruction">LD (HL),$1B</td>
</tr>
<tr>
<td class="address-1"><span id="60885"></span>EDD5</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="address-1"><span id="60886"></span>EDD6</td>
<td class="instruction">DJNZ $EDD3</td>
</tr>
<tr>
<td class="address-1"><span id="60888"></span>EDD8</td>
<td class="instruction">ADD HL,DE</td>
</tr>
<tr>
<td class="address-1"><span id="60889"></span>EDD9</td>
<td class="instruction">DEC C</td>
</tr>
<tr>
<td class="address-1"><span id="60890"></span>EDDA</td>
<td class="instruction">JR NZ,$EDD1</td>
</tr>
<tr>
<td class="address-1"><span id="60892"></span>EDDC</td>
<td class="instruction">LD L,$24</td>
</tr>
<tr>
<td class="address-1"><span id="60894"></span>EDDE</td>
<td class="instruction">LD (HL),$09</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="60896"></span>
<div class="comments">
<div class="paragraph">
Displays the instructions for page three.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="60896"></span>EDE0</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="1">Restore our place in the instructions and call <a href="60558.html">PRINT_INSTRUCTIONS</a></td>
</tr>
<tr>
<td class="address-1"><span id="60897"></span>EDE1</td>
<td class="instruction">CALL <a href="60558.html">PRINT_INSTRUCTIONS</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="60900"></span>EDE4</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="1">Store our position in the instructions for later</td>
</tr>
<tr>
<td class="address-1"><span id="60901"></span>EDE5</td>
<td class="instruction">CALL <a href="60390.html">PAUSE</a></td>
<td class="comment-1" rowspan="1">Pause before allowing input (debounce)</td>
</tr>
<tr>
<td class="address-2"><span id="60904"></span>EDE8</td>
<td class="instruction">CALL <a href="25600.html#26664">$6828</a></td>
<td class="comment-1" rowspan="3">Loop until a key is pressed (using <a href="25600.html#26664">6828</a>)</td>
</tr>
<tr>
<td class="address-1"><span id="60907"></span>EDEB</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="address-1"><span id="60908"></span>EDEC</td>
<td class="instruction">JR Z,$EDE8</td>
</tr>
<tr>
<td class="address-1"><span id="60910"></span>EDEE</td>
<td class="instruction">LD HL,$5840</td>
<td class="comment-1" rowspan="5">Writes $30 (yellow/ black) to the attribute buffer $029F times starting at $5840</td>
</tr>
<tr>
<td class="address-1"><span id="60913"></span>EDF1</td>
<td class="instruction">LD (HL),$30</td>
</tr>
<tr>
<td class="address-1"><span id="60915"></span>EDF3</td>
<td class="instruction">LD DE,$5841</td>
</tr>
<tr>
<td class="address-1"><span id="60918"></span>EDF6</td>
<td class="instruction">LD BC,$029F</td>
</tr>
<tr>
<td class="address-1"><span id="60921"></span>EDF9</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="address-1"><span id="60923"></span>EDFB</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="2">Restore our place in the instructions and call <a href="60558.html">PRINT_INSTRUCTIONS</a></td>
</tr>
<tr>
<td class="address-1"><span id="60924"></span>EDFC</td>
<td class="instruction">CALL <a href="60558.html">PRINT_INSTRUCTIONS</a></td>
</tr>
<tr>
<td class="address-1"><span id="60927"></span>EDFF</td>
<td class="instruction">CALL <a href="60390.html">PAUSE</a></td>
<td class="comment-1" rowspan="1">Pause before allowing input (debounce)</td>
</tr>
<tr>
<td class="address-2"><span id="60930"></span>EE02</td>
<td class="instruction">CALL <a href="25600.html#26664">$6828</a></td>
<td class="comment-1" rowspan="3">Loop until a key is pressed (using <a href="25600.html#26664">6828</a>)</td>
</tr>
<tr>
<td class="address-1"><span id="60933"></span>EE05</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="address-1"><span id="60934"></span>EE06</td>
<td class="instruction">JR Z,$EE02</td>
</tr>
<tr>
<td class="address-1"><span id="60936"></span>EE08</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="60587.html">ECAB</a>
</td>
<td class="up">Up: <a href="../maps/all.html#60754">Map</a></td>
<td class="next">
Next: <a href="60937.html">EE09</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; 1983 Microsphere &copy; 2021 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.5.</div>
</footer>
</body>
</html>